<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Termin√°l Magik√°na</title>
<style>
body {
  background: #0a0a0a;
  color: #00ff9d;
  font-family: Consolas, monospace;
  margin: 0;
  padding: 0;
}
header {
  background: #111;
  color: #00ff9d;
  padding: 10px;
  text-align: center;
  font-size: 1.3em;
  border-bottom: 1px solid #00ff9d;
}
#switcher {
  display: flex;
  justify-content: center;
  margin: 10px;
  gap: 10px;
}
button {
  background: #0f0f0f;
  color: #00ff9d;
  border: 1px solid #00ff9d;
  padding: 5px 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: 0.2s;
}
button:hover {
  background: #00ff9d;
  color: #000;
}
#terminal, #chat {
  display: none;
  margin: 20px auto;
  width: 80%;
  max-width: 800px;
  border: 1px solid #00ff9d;
  border-radius: 8px;
  padding: 15px;
  background: #111;
}
#log {
  height: 300px;
  overflow-y: auto;
  background: #000;
  padding: 10px;
  margin-bottom: 10px;
}
#chatMessages {
  height: 300px;
  overflow-y: auto;
  background: #000;
  padding: 10px;
  margin-bottom: 10px;
}
#input, #chatInput {
  width: 80%;
  padding: 10px;
  background: #000;
  border: 1px solid #00ff9d;
  color: #00ff9d;
  border-radius: 5px;
}
#sendBtn, #sendChat {
  padding: 10px;
  border-radius: 5px;
}
.admin-panel {
  display: none;
  margin-top: 20px;
  padding: 10px;
  border-top: 1px solid #00ff9d;
}
.admin-panel h3 { color: #ff0070; }
.hidden { display: none; }
.msg-admin { color: #ff4b4b; }
.msg-user { color: #00ff9d; }
</style>
</head>
<body>
<header>üßô‚Äç‚ôÇÔ∏è Termin√°l Magik√°na</header>

<div id="switcher">
  <button id="btnTerminal">üñ•Ô∏è Termin√°l</button>
  <button id="btnChat">üí¨ Chat</button>
</div>

<div id="terminal">
  <div id="log"></div>
  <input id="input" placeholder="Zadej p≈ô√≠kaz nebo k√≥d...">
  <button id="sendBtn">Odeslat</button>

  <div class="admin-panel" id="adminPanel">
    <h3>ADMIN PANEL</h3>
    <p><b>Odeslat zpr√°vu:</b></p>
    <input id="msgUser" placeholder="Komu (nech pr√°zdn√© = v≈°em)">
    <input id="msgText" placeholder="Text zpr√°vy">
    <button id="sendAdminMsg">üì© Odeslat</button>
  </div>
</div>

<div id="chat">
  <div id="chatMessages"></div>
  <input id="chatInput" placeholder="Napi≈° zpr√°vu...">
  <button id="sendChat">Odeslat</button>
</div>

<script>
// === LOCAL DATA ===
let username = localStorage.getItem('username');
if(!username) {
  username = prompt("Zadej sv√© jm√©no (username):") || "Bezejmenn√Ω";
  localStorage.setItem('username', username);
}
let isAdmin = localStorage.getItem('isAdmin') === 'true';
let messages = JSON.parse(localStorage.getItem('chatMessages') || '[]');
let codes = JSON.parse(localStorage.getItem('codes') || '{}');
const log = document.getElementById('log');
const chatBox = document.getElementById('chatMessages');

function appendLog(t,cls="msg-user") {
  const p = document.createElement('p');
  p.className = cls;
  p.textContent = t;
  log.appendChild(p);
  log.scrollTop = log.scrollHeight;
}
function appendChat(sender, text) {
  const div = document.createElement('div');
  div.innerHTML = `<b>${sender}:</b> ${text}`;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}
function saveChat() {
  localStorage.setItem('chatMessages', JSON.stringify(messages));
}
function refreshChat() {
  chatBox.innerHTML = '';
  messages.forEach(m => appendChat(m.user, m.text));
}

// === TERMINAL LOGIC ===
appendLog(`V√≠tej, ${username}!`);
appendLog("Napi≈° HELP pro seznam p≈ô√≠kaz≈Ø.");

const input = document.getElementById('input');
document.getElementById('sendBtn').addEventListener('click', ()=>{
  const cmd = input.value.trim();
  if(!cmd) return;
  processCommand(cmd);
  input.value='';
});

function processCommand(cmd){
  appendLog(`> ${cmd}`);
  if(cmd.toLowerCase()==="help"){
    appendLog("P≈ô√≠kazy: HELP, RESET, FILIP (admin), ORSAG (zpƒõt), MYCODES");
  }
  else if(cmd==="Filip"){
    isAdmin=true; localStorage.setItem('isAdmin','true');
    document.getElementById('adminPanel').style.display='block';
    appendLog("Admin m√≥d aktivov√°n!");
  }
  else if(cmd==="Orsag"){
    isAdmin=false; localStorage.setItem('isAdmin','false');
    document.getElementById('adminPanel').style.display='none';
    appendLog("Admin m√≥d vypnut.");
  }
  else if(codes[cmd]){
    appendLog(`Magik√°n ≈ô√≠k√°: ${codes[cmd].msg}`);
  } else {
    appendLog("Nezn√°m√Ω k√≥d.");
  }
}

document.getElementById('sendAdminMsg').addEventListener('click',()=>{
  const user=document.getElementById('msgUser').value.trim();
  const text=document.getElementById('msgText').value.trim();
  if(!text) return;
  if(user){
    messages.push({user:"Admin ‚Üí "+user,text});
  } else {
    messages.push({user:"Admin (v≈°em)",text});
  }
  saveChat(); refreshChat();
  appendLog("Zpr√°va odesl√°na.");
  document.getElementById('msgText').value='';
});

// === CHAT ===
document.getElementById('sendChat').addEventListener('click',()=>{
  const text=document.getElementById('chatInput').value.trim();
  if(!text) return;
  const msg={user:username,text};
  messages.push(msg);
  saveChat(); refreshChat();
  document.getElementById('chatInput').value='';
});

// === SWITCHER ===
document.getElementById('btnTerminal').onclick=()=>{
  document.getElementById('terminal').style.display='block';
  document.getElementById('chat').style.display='none';
};
document.getElementById('btnChat').onclick=()=>{
  document.getElementById('terminal').style.display='none';
  document.getElementById('chat').style.display='block';
  refreshChat();
};

// init
if(isAdmin) document.getElementById('adminPanel').style.display='block';
document.getElementById('terminal').style.display='block';
refreshChat();
</script>
</body>
</html>
